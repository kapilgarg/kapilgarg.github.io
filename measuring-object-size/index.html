<!DOCTYPE html>
<html lang="en">
<head>

    <title>Measuring object size with getsizeof</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=776d70e7aa" />

    <link rel="canonical" href="https://kapilgarg.github.io/measuring-object-size/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://kapilgarg.github.io/measuring-object-size/amp/" />
    
    <meta property="og:site_name" content="basic function" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Measuring object size with getsizeof" />
    <meta property="og:description" content="One of my colleague was running a batch to insert records in AWS firehose stream and getting service unavailable exception continuously. Probably, batch was inserting more data than allowed per second. So We thought of adding a log statement which prints the size of records which are sent to firehose." />
    <meta property="og:url" content="https://kapilgarg.github.io/measuring-object-size/" />
    <meta property="article:published_time" content="2020-06-15T04:09:53.000Z" />
    <meta property="article:modified_time" content="2020-06-15T04:09:53.000Z" />
    <meta property="article:tag" content="python" />
    <meta property="article:tag" content="getsizeof" />
    <meta property="article:tag" content="programmimg" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Measuring object size with getsizeof" />
    <meta name="twitter:description" content="One of my colleague was running a batch to insert records in AWS firehose stream and getting service unavailable exception continuously. Probably, batch was inserting more data than allowed per second. So We thought of adding a log statement which prints the size of records which are sent to firehose." />
    <meta name="twitter:url" content="https://kapilgarg.github.io/measuring-object-size/" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="KAPIL" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="python, getsizeof, programmimg" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "basic function",
        "url": "https://kapilgarg.github.io/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://kapilgarg.github.io/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "KAPIL",
        "url": "https://kapilgarg.github.io/author/kapil-2/",
        "sameAs": []
    },
    "headline": "Measuring object size with getsizeof",
    "url": "https://kapilgarg.github.io/measuring-object-size/",
    "datePublished": "2020-06-15T04:09:53.000Z",
    "dateModified": "2020-06-15T04:09:53.000Z",
    "keywords": "python, getsizeof, programmimg",
    "description": "One of my colleague was running a batch to insert records in AWS firehose stream and getting service unavailable exception continuously. Probably, batch was inserting more data than allowed per second. So We thought of adding a log statement which prints the size of records which are sent to firehose.\n\nAfter adding the log statement, we restarted the process and when we checked the logs for object size, all the objects were of same size !!! 2464 bytes. We were using put_record_batch API and we f",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://kapilgarg.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.1" />
    <link rel="alternate" type="application/rss+xml" title="basic function" href="https://kapilgarg.github.io/rss/" />
    <script defer src="https://unpkg.com/@tryghost/portal@~2.1.0/umd/portal.min.js" data-ghost="https://kapilgarg.github.io/" data-key="6411187770ec86e91904481ed3" data-api="https://kapilgarg.github.io/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style><style>:root {--ghost-accent-color: #15171A;}</style>
    <!-- link tag -->

</head>
<body class="post-template tag-python tag-getsizeof tag-programmimg has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <nav class="gh-head-inner inner">

            <div class="gh-head-brand">
                <a class="gh-head-logo no-image" href="https://kapilgarg.github.io">
                        basic function
                </a>
                <a class="gh-burger" role="button">
                    <div class="gh-burger-box">
                        <div class="gh-burger-inner"></div>
                    </div>
                </a>
            </div>
            <div class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://kapilgarg.github.io/">Home</a></li>
</ul>

            </div>
            <div class="gh-head-actions">
                <div class="gh-social">
                </div>
                        <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
            </div>
        </nav>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-python tag-getsizeof tag-programmimg no-image ">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/python/">python</a>
                </span>
        </div>

        <h1 class="article-title">Measuring object size with getsizeof</h1>


        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/kapil-2/" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/kapil-2/">KAPIL</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2020-06-15">Jun 15, 2020</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                </div>
            </div>

        </section>
        </div>


    </header>

    <section class="gh-content gh-canvas">
        <p>One of my colleague was running a batch to insert records in AWS firehose stream and getting service unavailable exception continuously. Probably, batch was inserting more data than allowed per second. So We thought of adding a log statement which prints the size of records which are sent to firehose.</p><p>After adding the log statement, we restarted the process and when we checked the logs for object size, all the objects were of same size !!! <strong>2464 bytes</strong>. We were using <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/firehose.html#Firehose.Client.put_record_batch">put_record_batch</a> API and we fixed the batch size to 300 but all the objects were not of the same size in a given batch. This is certainly not correct because the size should be somewhere close <strong> </strong>to 1 MB.</p><p>This was happening because of how <a href="https://docs.python.org/3/library/sys.html#sys.getsizeof">getsizeof</a> works. </p><p>This was the log statement added to print the size of records in bytes</p><pre><code>logger.info('batch size = ' + str(getsizeof(batch)))

firehoseClient.put_record_batch(DeliveryStreamName='my_delivery_stream', Records=batch)</code></pre><p>here, variable <em>batch</em> is a list which contains the objects to be sent to firehose. </p><p>The way <a href="https://docs.python.org/3/library/sys.html#sys.getsizeof">getsizeof</a> works is - it gets you the size of objects it <strong>contains </strong>and <strong>not the one it refers to</strong>. In this case, since list contained 300 objects, it was returning size of 300, 8 byte pointers added with the default size of list.</p><pre><code>#size of an empty list
&gt;&gt;&gt; from sys import getsizeof
&gt;&gt;&gt; getsizeof([])
64

# a temporary class for demo
&gt;&gt;&gt; class Temp():
...     pass

#size of list containing a single object 
&gt;&gt;&gt; getsizeof([Temp()])
72</code></pre><p>Size of an empty list is 64 bytes and when an object is added to it, size of that list only increased by 8 bytes. because it contains only the pointer to this object and not the actual object.</p><p>To get the size including the all the objects which this list refers to, you can use this recipe which gets the size of each object in the list and add that to the size of list.</p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://code.activestate.com/recipes/577504/"><div class="kg-bookmark-content"><div class="kg-bookmark-title">Compute Memory footprint of an object and its contents « Python recipes « ActiveState Code</div><div class="kg-bookmark-description"></div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://code.activestate.com/static/activestyle/img/favicon.ico" alt=""><span class="kg-bookmark-publisher">Jean Brouwers</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://code.activestate.com/static/img/bullet_disk.png" alt=""></div></a></figure><p>If you are interested, some more reading on the same </p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://code.tutsplus.com/tutorials/understand-how-much-memory-your-python-objects-use--cms-25609#:~:text&#x3D;An%20empty%20list%20takes%2072,an%20int%20is%2024%20bytes."><div class="kg-bookmark-content"><div class="kg-bookmark-title">Understand How Much Memory Your Python Objects Use</div><div class="kg-bookmark-description">Python is a fantastic programming language. It is also known for being pretty slow, due mostly to its enormous flexibility and dynamic features. For many applications and domains it is not a...</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://static.tutsplus.com/assets/apple-touch-icon-edce48c2c1293474a34fa8f1c87b5685.png" alt=""><span class="kg-bookmark-author">Envato Tuts</span><span class="kg-bookmark-publisher">Gigi Sayfan</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://cms-assets.tutsplus.com/uploads/users/1199/posts/25609/preview_image/python.png" alt=""></div></a></figure>
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post post-access-public">

    <a class="post-card-image-link" href="/coming-soon/">

        <img class="post-card-image"
            srcset="https://static.ghost.org/v4.0.0/images/feature-image.jpg 300w,
                    https://static.ghost.org/v4.0.0/images/feature-image.jpg 600w,
                    https://static.ghost.org/v4.0.0/images/feature-image.jpg 1000w,
                    https://static.ghost.org/v4.0.0/images/feature-image.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="https://static.ghost.org/v4.0.0/images/feature-image.jpg"
            alt="Coming soon"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/coming-soon/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Coming soon
                </h2>
            </header>
                <div class="post-card-excerpt">This is basic function, a brand new site by kapil that's just getting started. Things will be up and running here shortly, but you can subscribe in the meantime if you'd like to stay up to date and receive emails when new content is published!</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-05-30">May 30, 2022</time>
        </footer>

    </div>

</article>
                        
<article class="post-card post featured no-image post-access-public">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/mock-environment-variable-in-unittest/">
            <header class="post-card-header">
                <div class="post-card-tags">
                        <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
                </div>
                <h2 class="post-card-title">
                    Mock environment variable in unittest
                </h2>
            </header>
                <div class="post-card-excerpt">While writing test cases, you may need to mock one or more environment variables. It could be because environment variable it used as a flag for certain functionality or something else.

Environment variables are available through os.environ api. Though technically os.environ [1] is not a dictionary but it</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-03-08">Mar 8, 2022</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">2 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post no-image post-access-public">


    <div class="post-card-content">

        <a class="post-card-content-link" href="/write-a-file-watcher-and-read-the-delta/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Write a file-watcher and read the delta...
                </h2>
            </header>
                <div class="post-card-excerpt">While working on an on-premise compute grid, there was a need to monitor the status of various jobs running on worker nodes. There is a scheduler which assign tasks to worker nodes and maintains the status of each job. As a job moves through various stages of its life cycle,</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2022-02-20">Feb 20, 2022</time>
                <span class="sep">—</span>
                <span class="post-card-meta-length">1 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://kapilgarg.github.io">basic function</a> &copy; 2022</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="/assets/built/casper.js?v=776d70e7aa"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<!-- script tag -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169335725-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169335725-1');
</script>

</body>
</html>
